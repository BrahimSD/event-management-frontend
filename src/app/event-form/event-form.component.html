<div class="event-form-container">
  <h2 class="form-title">{{ isEditMode ? 'Edit Event' : 'Create Event' }}</h2>
  <form (ngSubmit)="saveEvent()" class="event-form" #eventForm="ngForm">
    <div class="form-group">
      <label for="name">Event Name</label>
      <input type="text" id="name" [(ngModel)]="event.name" name="name" placeholder="Enter event name" required
        #name="ngModel">
      <div class="error-message" *ngIf="name.invalid && (name.dirty || name.touched)">
        Event name is required
      </div>
    </div>

    <div class="form-group">
      <label for="description">Description</label>
      <textarea id="description" [(ngModel)]="event.description" name="description" placeholder="Event description"
        required #description="ngModel"></textarea>
      <div class="error-message" *ngIf="description.invalid && (description.dirty || description.touched)">
        Description is required
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="date">Date</label>
        <input type="date" id="date" [(ngModel)]="event.date" name="date" required #date="ngModel">
        <div class="error-message" *ngIf="date.invalid && (date.dirty || date.touched)">
          Date is required
        </div>
      </div>

      <div class="form-group">
        <label for="time">Time</label>
        <input type="time" id="time" [(ngModel)]="event.time" name="time" required #time="ngModel">
        <div class="error-message" *ngIf="time.invalid && (time.dirty || time.touched)">
          Time is required
        </div>
      </div>
    </div>

    <div class="form-group location-group">
      <label for="location">Location</label>
      <div class="location-input-wrapper">
        <input 
          type="text" 
          id="location" 
          [(ngModel)]="event.location" 
          name="location" 
          required 
          #location="ngModel"
          placeholder="Search for a location in France"
          autocomplete="off">
        <button type="button" class="auto-locate-btn" (click)="getCurrentLocation()" title="Use current location">
          <i class="fas fa-location-arrow"></i>
        </button>
      </div>
      <div class="error-message" *ngIf="location.invalid && (location.dirty || location.touched)">
        Location is required
      </div>
      <div class="error-message" *ngIf="errorMessage">{{ errorMessage }}</div>
    </div>

    <div class="form-group">
      <label for="image">Event Image</label>
      <div class="image-upload">
        <input type="file" id="image" (change)="onFileSelected($event)" accept="image/*" #imageInput>
        <label for="image" class="upload-label">
          <i class="fas fa-cloud-upload-alt"></i>
          <span>Choose an image (max 10MB)</span>
        </label>
        <div class="error-message" *ngIf="errorMessage">
          {{ errorMessage }}
        </div>
        <div class="preview-container" *ngIf="event.image">
          <img [src]="event.image" alt="Preview" class="image-preview">
        </div>
      </div>
    </div>

    <div class="form-actions">
      <button type="button" class="btn-cancel" (click)="cancel()">Cancel</button>
      <button type="submit" class="btn-submit" [disabled]="!eventForm.form.valid">
        {{ isEditMode ? 'Update Event' : 'Create Event' }}
      </button>
    </div>
  </form>
</div>